function prettify(e){const t=["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr","circle","ellipse","line","path","polygon","polyline","rect","stop","use"],r=["blockquote","body","br","div","h1","h2","h3","h4","h5","h6","head","hr","link","meta","p","table","td","title","tr","nav","section","header","footer","main","aside","article","address"],n=e=>t.includes(e.toLowerCase()),l=e=>r.includes(e.toLowerCase()),o={children:[]};function a(t,r=(()=>{})){const n=t.exec(e);if(null!==n){const[t,...l]=n;return e=e.substr(t.length),r(...l),t}return!1}function i(e){for(;a(/^\s+([a-zA-Z][a-zA-Z0-9\-]+)(?:="([^"]*)")?/,((t,r)=>{e.attributes[t]=r})););if(match=a(/^\s*\/?>/))return match.endsWith("/>");throw new Error("Malformed open tag")}try{!function t(r){let l=!0;for(;l&&e.length>0;)if(!(a(/^<([a-zA-Z][a-zA-Z0-9\-]*)/,(e=>{const l={tag:e,attributes:{},children:[]};r.children.push(l);let o=i(l);o&&(l.closed=!0),n(e)||o||t(l)}))||a(/^<\/([a-zA-Z][a-zA-Z0-9\-]*)>/,(e=>{if(void 0===r.tag||r.tag.toLowerCase()!==e.toLowerCase())throw new Error("Closing tag doesn't match: "+r.tag);l=!1}))||a(/^([^<]+)/,(e=>{ttext=e.replace(/^\s+|\s+$/g,"").replace(/\n/g," ").replace(/ +/," "),ttext&&r.children.push({text:ttext})}))))throw new Error("Parsing Error: No rules matched")}(o)}catch(e){return!1}function d(e,t=0){let r="  ".repeat(t);if(e.text)return e.text;let o="";return t&&l(e.tag)&&(o+="\n"+r),o+=`<${e.tag} `,Object.keys(e.attributes).forEach((t=>{e.attributes[t]?o+=t+'="'+e.attributes[t]+'" ':o+=t+'="" '})),o+=e.closed?" />":">",e.children.forEach((e=>{o+=d(e,t+1)})),l(e.tag)&&(o+="\n"+r),e.closed||n(e.tag)||(o+=`</${e.tag}>`),o}let c="";return o.children.forEach((e=>{c+=d(e,0)+"\n"})),c=c.replace(/ >/g,">").replace(/ +\/>/g," />").replace(/(?<=[^>\s])\s+</g,"<").replace(/(\n\s+)?\n/g,"\n"),c}class EditHtml{constructor(e){const t=e.getModule("toolbar");if(!t)throw new Error('quill.htmlEditButton requires the "toolbar" module to be included too');let r=document.createElement("span");r.setAttribute("class","ql-formats");let n=document.createElement("button");n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M384 121.941V128H256V0h6.059c6.365 0 12.47 2.529 16.971 7.029l97.941 97.941A24.005 24.005 0 0 1 384 121.941zM248 160c-13.2 0-24-10.8-24-24V0H24C10.745 0 0 10.745 0 24v464c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24V160H248zM123.206 400.505a5.4 5.4 0 0 1-7.633.246l-64.866-60.812a5.4 5.4 0 0 1 0-7.879l64.866-60.812a5.4 5.4 0 0 1 7.633.246l19.579 20.885a5.4 5.4 0 0 1-.372 7.747L101.65 336l40.763 35.874a5.4 5.4 0 0 1 .372 7.747l-19.579 20.884zm51.295 50.479l-27.453-7.97a5.402 5.402 0 0 1-3.681-6.692l61.44-211.626a5.402 5.402 0 0 1 6.692-3.681l27.452 7.97a5.4 5.4 0 0 1 3.68 6.692l-61.44 211.626a5.397 5.397 0 0 1-6.69 3.681zm160.792-111.045l-64.866 60.812a5.4 5.4 0 0 1-7.633-.246l-19.58-20.885a5.4 5.4 0 0 1 .372-7.747L284.35 336l-40.763-35.874a5.4 5.4 0 0 1-.372-7.747l19.58-20.885a5.4 5.4 0 0 1 7.633-.246l64.866 60.812a5.4 5.4 0 0 1-.001 7.879z"/></svg>',n.title="Show HTML source",n.onclick=e=>{this.launch()},r.appendChild(n),t.container.append(r),this.quill=e}launch(){let e=(new DOMParser).parseFromString('\n    <div id="htmlEdit" style="z-index:1050; background-color: #e5e7ebe6; bottom: 0; top: 0; right: 0; left: 0; position: fixed;">\n      <div style="padding: 2rem 1rem; display: flex; flex-direction: column; width: 100%; height: 100%; ">\n        <div style="padding: 1.25rem; flex-grow: 1;">\n          <span style="color: rgb(71 85 105); margin: 0.25rem; font-style: italic; ">Edit HTML here</span>\n          <textarea style="padding: 0.5rem; background-color: white; border-radius: 0.5rem; width: 100%; height: 100%; "></textarea>      \n        </div>\n        <div style="padding: 1rem; gap: 1rem; justify-content: center; display: flex;">\n            <button id="htmlEditCancel" style="padding: 0.5rem 1rem; background-color: white; border-radius: 0.375rem">Cancel</button>\n            <button id="htmlEditOk" style="padding: 0.5rem 1rem; background-color: white; border-radius: 0.375rem">Ok</button>\n          </div>\n      </div>\n    </div>\n    ',"text/html").body.firstElementChild,t=prettify(this.quill.root.innerHTML)||this.quill.root.innerHTML;document.body.append(e);let r=document.querySelector("#htmlEdit textarea");r.value=t,r.focus(),document.getElementById("htmlEditCancel").onclick=t=>{t.preventDefault(),document.body.removeChild(e)},document.getElementById("htmlEditOk").onclick=t=>{t.preventDefault(),this.quill.root.innerHTML=r.value,document.body.removeChild(e)}}}