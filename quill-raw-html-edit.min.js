function prettify(t){const e=["area","base","br","col","embed","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"],r=["address","article","aside","audio","blockquote","body","br","canvas","datalist","dd","details","div","dl","fieldset","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hr","link","main","meta","nav","ol","optgroup","p","picture","pre","ruby","script","section","style","svg","table","tbody","template","tfoot","thead","title","tr","ul","video"],n=["dd","dt","figcaption","li","option","summary","td"],o=t=>e.includes(t.toLowerCase()),a=t=>r.includes(t.toLowerCase()),l={children:[]};function i(e,r=(()=>{})){const n=e.exec(t);if(null!==n){const[e,...o]=n;return t=t.substr(e.length),r(...o),e}return!1}function d(t){for(;i(/^\s+([a-zA-Z][a-zA-Z0-9\-]*)(?:="([^"]*)")?/,((e,r)=>{t.attributes[e]=r})););if(match=i(/^\s*\/?>/))return match.endsWith("/>");throw new Error("Malformed open tag: "+t.tag)}try{!function e(r){let n=!0;for(;n&&t.length>0;)if(!(i(/^<([a-zA-Z][a-zA-Z0-9\-]*)/,(t=>{const n={tag:t,attributes:{},children:[]};r.children.push(n);let a=d(n);a&&(n.closed=!0),o(t)||a||e(n)}))||i(/^<\/([a-zA-Z][a-zA-Z0-9\-]*)>/,(t=>{if(void 0===r.tag||r.tag.toLowerCase()!==t.toLowerCase())throw new Error("Closing tag doesn't match: "+r.tag);n=!1}))||i(/^([^<]+)/,(t=>{ttext=t.trim().replace(/\s+|\n/g," "),ttext&&r.children.push({text:ttext})}))))throw new Error("Parsing Error: No rules matched")}(l)}catch(t){return!1}function c(t,e=0){let r="  ".repeat(e);if(t.text)return t.text;let l="";var i;return e&&(a(t.tag)||(i=t.tag,n.includes(i.toLowerCase())))&&(l+="\n"+r),l+=`<${t.tag} `,Object.keys(t.attributes).forEach((e=>{t.attributes[e]?l+=e+'="'+t.attributes[e]+'" ':l+=e+'="" '})),l+=t.closed?" />":">",a(t.tag)&&(l+="\n  "+r),t.children.forEach((t=>{l+=c(t,e+1)})),a(t.tag)&&(l+="\n"+r),t.closed||o(t.tag)||(l+=`</${t.tag}>`),l}let s="";return l.children.forEach((t=>{s+=c(t,0)+"\n"})),s=s.replace(/ >/g,">").replace(/ +\/>/g," />").replace(/(\n\s+)?\n+/g,"\n"),s}class EditHtml{constructor(t){const e=t.getModule("toolbar");if(!e)throw new Error('quill-raw-html-edit requires the "toolbar" module to be included too');let r=document.createElement("span");r.setAttribute("class","ql-formats");let n=document.createElement("button");n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M384 121.941V128H256V0h6.059c6.365 0 12.47 2.529 16.971 7.029l97.941 97.941A24.005 24.005 0 0 1 384 121.941zM248 160c-13.2 0-24-10.8-24-24V0H24C10.745 0 0 10.745 0 24v464c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24V160H248zM123.206 400.505a5.4 5.4 0 0 1-7.633.246l-64.866-60.812a5.4 5.4 0 0 1 0-7.879l64.866-60.812a5.4 5.4 0 0 1 7.633.246l19.579 20.885a5.4 5.4 0 0 1-.372 7.747L101.65 336l40.763 35.874a5.4 5.4 0 0 1 .372 7.747l-19.579 20.884zm51.295 50.479l-27.453-7.97a5.402 5.402 0 0 1-3.681-6.692l61.44-211.626a5.402 5.402 0 0 1 6.692-3.681l27.452 7.97a5.4 5.4 0 0 1 3.68 6.692l-61.44 211.626a5.397 5.397 0 0 1-6.69 3.681zm160.792-111.045l-64.866 60.812a5.4 5.4 0 0 1-7.633-.246l-19.58-20.885a5.4 5.4 0 0 1 .372-7.747L284.35 336l-40.763-35.874a5.4 5.4 0 0 1-.372-7.747l19.58-20.885a5.4 5.4 0 0 1 7.633-.246l64.866 60.812a5.4 5.4 0 0 1-.001 7.879z"/></svg>',n.title="Show HTML source",n.onclick=t=>{this.launch()},r.appendChild(n),e.container.append(r),this.quill=t}launch(){let t=(new DOMParser).parseFromString('\n    <div id="htmlEdit" style="z-index:1050; background-color: #e5e7ebe6; bottom: 0; top: 0; right: 0; left: 0; position: fixed;">\n      <div style="padding: 2rem 1rem; display: flex; flex-direction: column; width: 100%; height: 100%; ">\n        <div style="padding: 1.25rem; flex-grow: 1;">\n          <span style="color: rgb(71 85 105); margin: 0.25rem; font-style: italic; ">Edit HTML here</span>\n          <textarea style="padding: 0.5rem; background-color: white; border-radius: 0.5rem; width: 100%; height: 100%; "></textarea>      \n        </div>\n        <div style="padding: 1rem; gap: 1rem; justify-content: center; display: flex;">\n            <button id="htmlEditCancel" style="padding: 0.5rem 1rem; background-color: white; border-radius: 0.375rem">Cancel</button>\n            <button id="htmlEditOk" style="padding: 0.5rem 1rem; background-color: white; border-radius: 0.375rem">Ok</button>\n          </div>\n      </div>\n    </div>\n    ',"text/html").body.firstElementChild,e=prettify(this.quill.root.innerHTML)||this.quill.root.innerHTML;document.body.append(t);let r=document.querySelector("#htmlEdit textarea");r.value=e,r.focus(),document.getElementById("htmlEditCancel").onclick=e=>{e.preventDefault(),document.body.removeChild(t)},document.getElementById("htmlEditOk").onclick=e=>{e.preventDefault(),this.quill.root.innerHTML=r.value,document.body.removeChild(t)}}}